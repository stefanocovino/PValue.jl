<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>pValue.jl · pValue.jl</title><meta name="title" content="pValue.jl · pValue.jl"/><meta property="og:title" content="pValue.jl · pValue.jl"/><meta property="twitter:title" content="pValue.jl · pValue.jl"/><meta name="description" content="Documentation for pValue.jl."/><meta property="og:description" content="Documentation for pValue.jl."/><meta property="twitter:description" content="Documentation for pValue.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>pValue.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>pValue.jl</a><ul class="internal"><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>pValue.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>pValue.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/stefanocovino/pValue.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/stefanocovino/pValue.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="pValue.jl"><a class="docs-heading-anchor" href="#pValue.jl">pValue.jl</a><a id="pValue.jl-1"></a><a class="docs-heading-anchor-permalink" href="#pValue.jl" title="Permalink"></a></h1><p>Documentation for pValue.jl</p><p>A set of sparse julia functions for computing p-values in a &quot;frequentist&quot; or &quot;Bayesian&quot; scenario.</p><ul><li><a href="#pValue.jl">pValue.jl</a></li><li class="no-marker"><ul><li><a href="#Functions">Functions</a></li><li><a href="#Index">Index</a></li></ul></li></ul><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="pValue.BIC-Tuple{AbstractFloat, Integer, Integer}" href="#pValue.BIC-Tuple{AbstractFloat, Integer, Integer}"><code>pValue.BIC</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">BIC(lp::AbstractFloat,ndata::Integer,nvar::Integer)</code></pre><p>Computes the <a href="https://en.wikipedia.org/wiki/Bayesian_information_criterion">Bayes Information Criterion</a>. &#39;lp&#39; is the logarithm of the likelihood, &#39;ndata&#39; the number of datapoints and &#39;nvar&#39; the number of model parameters.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">BIC(56.,100,3)

# output

-98.18448944203573</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/pValue.jl/blob/48a645419d542e59b1ad5f89047f85c594621384/src/pValue.jl#L17-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="pValue.Frequentist_p_value-Tuple{Any, Any, Any}" href="#pValue.Frequentist_p_value-Tuple{Any, Any, Any}"><code>pValue.Frequentist_p_value</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Frequentist_p_value(ssrv,ndata,nvar)
Frequentist_p_value(ssrv,ndof)</code></pre><p>Compute the &#39;classic&#39; frequentist <a href="https://en.wikipedia.org/wiki/P-value">p-value</a>. &#39;ssrv&#39; is the SSR, the sum of squared residuals, &#39;ndata&#39; the number of datapoints and &#39;nvar&#39; the number of fit parameters. Else, &#39;ndof&#39; is the number of <a href="https://en.wikipedia.org/wiki/Degrees_of_freedom_(statistics)">degrees of freedom</a> (i.e. ndata-nvar).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">Frequentist_p_value(85.3,100,10)

# output

0.620453567577112</code></pre><pre><code class="language-julia hljs">Frequentist_p_value(85.3,90)

# output

0.620453567577112</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/pValue.jl/blob/48a645419d542e59b1ad5f89047f85c594621384/src/pValue.jl#L40-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="pValue.Gelman_Bayesian_p_value-NTuple{4, Any}" href="#pValue.Gelman_Bayesian_p_value-NTuple{4, Any}"><code>pValue.Gelman_Bayesian_p_value</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Gelman_Bayesian_p_value(modvecs,simvecs,obsvec,errobsvec)</code></pre><p>Compute a &#39;Bayesian <a href="https://en.wikipedia.org/wiki/P-value">p-value</a>&#39; following the recipe by <a href="http://www.stat.columbia.edu/~gelman/book/">A. Gelman et al., 2013</a>.</p><p><strong>Explanation</strong></p><p>&#39;obsvec&#39; and &#39;errobsvec&#39; are length-&#39;m&#39; vectors of datapoints and relative uncertainties. &#39;modvecs&#39; is a vector computed by the posterior distribution of parameters (&#39;n&#39; chains), e.g. by a MCMC, where each component is a vector of &#39;m&#39; values computed using the fit function and each set of parmeters from the posterior distribution. Finally, &#39;simvecs&#39; is like &#39;modevecs&#39; with the addition of the predicted noise, i.e. these are simulated datapoints.</p><p>The routinely essentially compares the SSR (or, in principle, any test statistics) of each model based on the derived posterior distribution of parameters vs the data and to SSR computed by simulated data and again the posterior.</p><p><strong>Examples</strong></p><p>A full example of application of the <strong>Gelman<em>Bayesian</em>p_value</strong> as well as the <strong>Lucy<em>Bayesian</em>p_value</strong> and the <strong>Frequentist<em>p</em>value</strong> is reported in this Jupyter <a href="https://github.com/stefanocovino/MyJuliaPkg.jl/main/docs/BayesianFitTest.ipynb">notebook</a>.</p><p>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/pValue.jl/blob/48a645419d542e59b1ad5f89047f85c594621384/src/pValue.jl#L79-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="pValue.Lucy_Bayesian_p_value-NTuple{4, Any}" href="#pValue.Lucy_Bayesian_p_value-NTuple{4, Any}"><code>pValue.Lucy_Bayesian_p_value</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Lucy_Bayesian_p_value(modvecs,obsvec,errobsvec,nvars)</code></pre><p>Compute a &#39;Bayesian <a href="https://en.wikipedia.org/wiki/P-value">p-value</a>&#39; following the recipe by <a href="https://ui.adsabs.harvard.edu/abs/2016A%26A...588A..19L/abstract">L.B. Lucy, 2016, A&amp;A 588, 19</a>.</p><p><strong>Explanation</strong></p><p>&#39;obsvec&#39; and &#39;errobsvec&#39; are length-&#39;m&#39; vectors of datapoints and relative uncertainties. &#39;modvecs&#39; is a vector computed by the posterior distribution of parameters (&#39;n&#39; chains), e.g. by a MCMC, where each component is a vector of &#39;m&#39; values computed using the fit function and each set of parmeters from the posterior distribution. Finally, &#39;nvars&#39; is the number of parameters.</p><p>This algorithm relies on the Chi2 distribution as in the &#39;frequentist&#39; case. Howver the SSR is not based only on a punt estimate but it is computed by the whole posterior distribution of parameters.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">x = [1,2,3,4,5]
y = [1.01,1.95,3.05,3.97,5.1]
ey = [0.05,0.1,0.11,0.17,0.2]

f(x;a=1.,b=0.) = a.*x.+b

# Sample from a fake posterior distribution
ch = DataFrame(a=[0.99,0.95,1.01,1.02,1.03], b=[0.,-0.01,0.01,0.02,-0.01])

res = []
for i in 1:nrow(ch)
    push!(res,f(x;a=ch[i,:a],b=ch[i,:b]))
end

Lucy_Bayesian_p_value(res,y,ey,2)

# output

0.7200318895143041</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/pValue.jl/blob/48a645419d542e59b1ad5f89047f85c594621384/src/pValue.jl#L127-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="pValue.RMS-Tuple{Any, Any}" href="#pValue.RMS-Tuple{Any, Any}"><code>pValue.RMS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RMS(datavec,modvec)</code></pre><p>Computes the <a href="https://en.wikipedia.org/wiki/Root_mean_square">Root Mean Square value</a>. &#39;datavec&#39; and &#39;modvec&#39; are vectors formed by datapoints and model values to be compared with.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">RMS([1.1,2.2],[1.15,2.15])

# output

0.050000000000000044</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/pValue.jl/blob/48a645419d542e59b1ad5f89047f85c594621384/src/pValue.jl#L177-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="pValue.SSR-Tuple{Any, Any, Any}" href="#pValue.SSR-Tuple{Any, Any, Any}"><code>pValue.SSR</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">SSR(modvec,obsvec,errobsvec)</code></pre><p>Computes the <a href="https://en.wikipedia.org/wiki/Residual_sum_of_squares">Sum of Squared Residuals</a>. &#39;modvec&#39;, &#39;obsvec&#39; and &#39;errobsvec&#39; are vectors with the model predictions, observed data and errors, respectively.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">SSR([1.,2.,3.,4.],[1.1,1.9,3.05,3.8],[0.1,0.05,0.2,0.1])

# output

9.062500000000016</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/pValue.jl/blob/48a645419d542e59b1ad5f89047f85c594621384/src/pValue.jl#L200-L216">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#pValue.BIC-Tuple{AbstractFloat, Integer, Integer}"><code>pValue.BIC</code></a></li><li><a href="#pValue.Frequentist_p_value-Tuple{Any, Any, Any}"><code>pValue.Frequentist_p_value</code></a></li><li><a href="#pValue.Gelman_Bayesian_p_value-NTuple{4, Any}"><code>pValue.Gelman_Bayesian_p_value</code></a></li><li><a href="#pValue.Lucy_Bayesian_p_value-NTuple{4, Any}"><code>pValue.Lucy_Bayesian_p_value</code></a></li><li><a href="#pValue.RMS-Tuple{Any, Any}"><code>pValue.RMS</code></a></li><li><a href="#pValue.SSR-Tuple{Any, Any, Any}"><code>pValue.SSR</code></a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Sunday 21 April 2024 13:21">Sunday 21 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
