<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PValue.jl · PValue.jl</title><meta name="title" content="PValue.jl · PValue.jl"/><meta property="og:title" content="PValue.jl · PValue.jl"/><meta property="twitter:title" content="PValue.jl · PValue.jl"/><meta name="description" content="Documentation for PValue.jl."/><meta property="og:description" content="Documentation for PValue.jl."/><meta property="twitter:description" content="Documentation for PValue.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>PValue.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>PValue.jl</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>PValue.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PValue.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/stefanocovino/PValue.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/stefanocovino/PValue.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PValue.jl"><a class="docs-heading-anchor" href="#PValue.jl">PValue.jl</a><a id="PValue.jl-1"></a><a class="docs-heading-anchor-permalink" href="#PValue.jl" title="Permalink"></a></h1><p>Documentation for PValue.jl</p><p>A set of sparse julia functions for computing p-values in a &quot;frequentist&quot; or &quot;Bayesian&quot; scenario.</p><ul><li><a href="#PValue.jl">PValue.jl</a></li><li class="no-marker"><ul><li><a href="#Index">Index</a></li></ul></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#PValue.BIC-Tuple{AbstractFloat, Integer, Integer}"><code>PValue.BIC</code></a></li><li><a href="#PValue.Frequentist_p_value-Tuple{Any, Any, Any}"><code>PValue.Frequentist_p_value</code></a></li><li><a href="#PValue.Gelman_Bayesian_p_value-NTuple{4, Any}"><code>PValue.Gelman_Bayesian_p_value</code></a></li><li><a href="#PValue.GetACF-Tuple{Any, Any}"><code>PValue.GetACF</code></a></li><li><a href="#PValue.GetPACF-Tuple{Vector{Float64}, Integer}"><code>PValue.GetPACF</code></a></li><li><a href="#PValue.Lucy_Bayesian_p_value-NTuple{4, Any}"><code>PValue.Lucy_Bayesian_p_value</code></a></li><li><a href="#PValue.RMS-Tuple{Any, Any}"><code>PValue.RMS</code></a></li><li><a href="#PValue.SSR-Tuple{Any, Any, Any}"><code>PValue.SSR</code></a></li><li><a href="#PValue.WeightedArithmeticMean-Tuple{Any, Any}"><code>PValue.WeightedArithmeticMean</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PValue.BIC-Tuple{AbstractFloat, Integer, Integer}" href="#PValue.BIC-Tuple{AbstractFloat, Integer, Integer}"><code>PValue.BIC</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BIC(lp::AbstractFloat,ndata::Integer,nvar::Integer)</code></pre><p>Compute the <a href="https://en.wikipedia.org/wiki/Bayesian_information_criterion">Bayes Information Criterion</a>.</p><p><strong>Arguments</strong></p><ul><li><code>lp</code> logarithm of the likelihood.</li><li><code>ndata</code> number of datapoints.</li><li><code>nvar</code> number of model parameters.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
BIC(56.,100,3)

# output

-98.18448944203573</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/PValue.jl/blob/08f3687f59bb8a3f5b8d675040ad4647e8e9ad91/src/PValue.jl#L21-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PValue.Frequentist_p_value-Tuple{Any, Any, Any}" href="#PValue.Frequentist_p_value-Tuple{Any, Any, Any}"><code>PValue.Frequentist_p_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Frequentist_p_value(ssrv,ndata,nvar)
Frequentist_p_value(ssrv,ndof)</code></pre><p>Compute the &#39;classic&#39; frequentist <a href="https://en.wikipedia.org/wiki/P-value">p-value</a>.</p><p><strong>Arguments</strong></p><ul><li><code>ssrv</code> SSR, the sum of squared residuals.</li><li><code>ndata</code> number of datapoints.</li><li><code>nvar</code> number of fit parameters.</li><li><code>ndof</code> number of <a href="https://en.wikipedia.org/wiki/Degrees_of_freedom_(statistics)">degrees of freedom</a></li></ul><p>(i.e. <span>$ndata-nvar$</span>).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
Frequentist_p_value(85.3,100,10)

# output

0.620453567577112</code></pre><pre><code class="language-julia hljs">Frequentist_p_value(85.3,90)

# output

0.620453567577112</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/PValue.jl/blob/08f3687f59bb8a3f5b8d675040ad4647e8e9ad91/src/PValue.jl#L49-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PValue.Gelman_Bayesian_p_value-NTuple{4, Any}" href="#PValue.Gelman_Bayesian_p_value-NTuple{4, Any}"><code>PValue.Gelman_Bayesian_p_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Gelman_Bayesian_p_value(modvecs,simvecs,obsvec,errobsvec)</code></pre><p>Compute a &#39;Bayesian <a href="https://en.wikipedia.org/wiki/P-value">p-value</a>&#39; following the recipe by <a href="http://www.stat.columbia.edu/~gelman/book/">A. Gelman et al., 2013</a>.</p><p><strong>Arguments</strong></p><ul><li><code>obsvec</code> datapoints.</li><li><code>errobsvec</code> datapoint uncertainties.</li><li><code>modvecs</code> model vector.</li><li><code>simvecs</code> simulated vector.</li></ul><p><strong>Explanation</strong></p><p><code>obsvec</code> and <code>errobsvec</code> are length-&#39;m&#39; vectors of datapoints and relative uncertainties. <code>modvecs</code> is a vector computed by the posterior distribution of parameters (<code>n</code> chains), e.g. by a MCMC, where each component is a vector of <code>m</code> values computed using the fit function and each set of parmeters from the posterior distribution. Finally, <code>simvecs</code> is like <code>modevecs</code> with the addition of the predicted noise, i.e. these are simulated datapoints.</p><p>The routinely essentially compares the SSR (or, in principle, any test statistics) of each model based on the derived posterior distribution of parameters vs the data and to SSR computed by simulated data and again the posterior.</p><p><strong>Examples</strong></p><p>A full example of application of the <strong>Gelman<em>Bayesian</em>p_value</strong> as well as the <strong>Lucy<em>Bayesian</em>p_value</strong> and the <strong>Frequentist<em>p</em>value</strong> is reported in this Jupyter <a href="https://github.com/stefanocovino/PValue.jl/tree/main/docs/BayesianFitTest.ipynb">notebook</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/PValue.jl/blob/08f3687f59bb8a3f5b8d675040ad4647e8e9ad91/src/PValue.jl#L95-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PValue.GetACF-Tuple{Any, Any}" href="#PValue.GetACF-Tuple{Any, Any}"><code>PValue.GetACF</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetACF(data::Vector{Float64},lags::Integer;sigma=1.96)</code></pre><p>Compute the [AutoCorrelation Function[(https://en.wikipedia.org/wiki/Autocorrelation) for the given lags. It returns a dictionary with the ACF and the minimum and maximum uncertainties against a white noise hypothesis.</p><p><strong>Arguments</strong></p><ul><li><code>data</code> logarithm of the likelihood.</li><li><code>lags</code> last lag to be computed.</li><li><code>sigma</code> number of sigmas for the uncertainties.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
GetACF([1.2,2.5,3.5,4.3],2)[&quot;ACF&quot;]

# output

3-element Vector{Float64}:
  1.0
  0.23928737773637632
 -0.2945971122496507</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/PValue.jl/blob/08f3687f59bb8a3f5b8d675040ad4647e8e9ad91/src/PValue.jl#L152-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PValue.GetPACF-Tuple{Vector{Float64}, Integer}" href="#PValue.GetPACF-Tuple{Vector{Float64}, Integer}"><code>PValue.GetPACF</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GetPACF(data::Vector{Float64},lags::Integer;sigma=1.96)</code></pre><p>Compute the [Partial AutoCorrelation Function[(https://en.wikipedia.org/wiki/Partial<em>autocorrelation</em>function) for the given lags. It returns a dictionary with the PACF and the minimum and maximum uncertainties.</p><p><strong>Arguments</strong></p><ul><li><code>data</code> logarithm of the likelihood.</li><li><code>lags</code> last lag to be computed.</li><li><code>sigma</code> number of sigmas for the uncertainties.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
GetPACF([1.2,2.5,3.5,4.3],1)[&quot;PACF&quot;]

# output

2-element Vector{Float64}:
 1.0
 0.7819548872180438</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/PValue.jl/blob/08f3687f59bb8a3f5b8d675040ad4647e8e9ad91/src/PValue.jl#L184-L207">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PValue.Lucy_Bayesian_p_value-NTuple{4, Any}" href="#PValue.Lucy_Bayesian_p_value-NTuple{4, Any}"><code>PValue.Lucy_Bayesian_p_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Lucy_Bayesian_p_value(modvecs,obsvec,errobsvec,nvars)</code></pre><p>Compute a &#39;Bayesian <a href="https://en.wikipedia.org/wiki/P-value">p-value</a>&#39; following the recipe by <a href="https://ui.adsabs.harvard.edu/abs/2016A%26A...588A..19L/abstract">L.B. Lucy, 2016, A&amp;A 588, 19</a>.</p><p><strong>Arguments</strong></p><ul><li><code>obsvec</code> datapoints.</li><li><code>errobsvec</code> datapoint uncertainties.</li><li><code>nvars</code> number of parameters.</li></ul><p><strong>Explanation</strong></p><p><code>obsvec</code> and <code>errobsvec</code> are length-<code>m</code> vectors of datapoints and relative uncertainties. <code>modvecs</code> is a vector computed by the posterior distribution of parameters (<code>n</code> chains), e.g. by a MCMC, where each component is a vector of <code>m</code> values computed using the fit function and each set of parmeters from the posterior distribution. Finally, <code>nvars</code> is the number of parameters.</p><p>This algorithm relies on the Chi2 distribution as in the &#39;frequentist&#39; case. Howver the SSR is not based only on a punt estimate but it is computed by the whole posterior distribution of parameters.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
x = [1,2,3,4,5]
y = [1.01,1.95,3.05,3.97,5.1]
ey = [0.05,0.1,0.11,0.17,0.2]

f(x;a=1.,b=0.) = a.*x.+b

# Sample from a fake posterior distribution
ch = DataFrame(a=[0.99,0.95,1.01,1.02,1.03], b=[0.,-0.01,0.01,0.02,-0.01])

res = []
for i in 1:nrow(ch)
    push!(res,f(x;a=ch[i,:a],b=ch[i,:b]))
end

Lucy_Bayesian_p_value(res,y,ey,2)

# output

0.7200318895143041</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/PValue.jl/blob/08f3687f59bb8a3f5b8d675040ad4647e8e9ad91/src/PValue.jl#L215-L268">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PValue.RMS-Tuple{Any, Any}" href="#PValue.RMS-Tuple{Any, Any}"><code>PValue.RMS</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RMS(datavec,modvec)</code></pre><p>Compute the <a href="https://en.wikipedia.org/wiki/Root_mean_square">Root Mean Square value</a>.</p><p><strong>Arguments</strong></p><ul><li><code>datavec</code> datapoints.</li><li><code>modvec</code> model values.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
RMS([1.1,2.2],[1.15,2.15])

# output

0.050000000000000044</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/PValue.jl/blob/08f3687f59bb8a3f5b8d675040ad4647e8e9ad91/src/PValue.jl#L282-L305">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PValue.SSR-Tuple{Any, Any, Any}" href="#PValue.SSR-Tuple{Any, Any, Any}"><code>PValue.SSR</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SSR(modvec,obsvec,errobsvec)</code></pre><p>Compute the <a href="https://en.wikipedia.org/wiki/Residual_sum_of_squares">Sum of Squared Residuals</a>.</p><p><strong>Arguments</strong></p><ul><li><code>modvec</code> model predictions.</li><li><code>obsvec</code> observed data.</li><li>`errobsvec~ uncertainties.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
SSR([1.,2.,3.,4.],[1.1,1.9,3.05,3.8],[0.1,0.05,0.2,0.1])

# output

9.062500000000016</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/PValue.jl/blob/08f3687f59bb8a3f5b8d675040ad4647e8e9ad91/src/PValue.jl#L312-L336">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PValue.WeightedArithmeticMean-Tuple{Any, Any}" href="#PValue.WeightedArithmeticMean-Tuple{Any, Any}"><code>PValue.WeightedArithmeticMean</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WeightedArithmeticMean(x,ex)</code></pre><p>Compute the <a href="https://en.wikipedia.org/wiki/Weighted_arithmetic_mean">Weighted Arithmetic Mean</a>.</p><p><strong>Arguments</strong></p><ul><li><code>x</code> input vector</li><li><code>ex</code> uncertainties.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">
x = [1.2,2.2,4.5,3,3.6]
ex = [0.2,0.2,0.5,0.1,0.6]

WeightedArithmeticMean(x,ex)

# output

(2.634301913536499, 0.07986523020975032)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/stefanocovino/PValue.jl/blob/08f3687f59bb8a3f5b8d675040ad4647e8e9ad91/src/PValue.jl#L343-L369">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 5 March 2025 06:14">Wednesday 5 March 2025</span>. Using Julia version 1.10.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
